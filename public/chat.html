<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Chat Room</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <!--引入 element-ui 的样式，-->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <!-- 必须先引入vue，  后使用element-ui -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.js"></script>
    <!-- 引入element 的组件库-->
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
</head>

<body>
<div id="app">
    <h1>Chat Room</h1>
    <div class="message-list">
        <div v-for="{type,msg} in messages">{{ type}}：{{ msg }}</div>
    </div>
    <div class="input-box">
        <input type="text" v-model="newMessage" @keyup.enter="sendMessage">
        <button @click="sendMessage">Send</button>
    </div>
</div>
</body>

</html>

<script>
  new Vue({
    el: '#app',
    data: {
      messages: [],
      newMessage: ''
    },
    created: function () {
    },
    methods: {
      sendMessage: function () {
        if (this.newMessage) {
          this.messages.push({type: "Q", msg: this.newMessage})
          const content = this.newMessage.slice()
          this.newMessage = ''
          let that = this;
          // 使用jQuery库发送POST请求
          $.ajax({
            type: 'POST',
            url: '/api/chat/question',
            timeout: 60000,
            jsonp: true,
            data: {content},
            success: function (res) {
              // 处理返回的数据
              that.messages.push({type: "A", msg: res.data})
            },
            error: function (err) {
              console.log(err)
              // 处理请求出错的情况
              that.messages.push({type: "A", msg: err.messages})
            }
          })
        }
      }
    }
  });
</script>